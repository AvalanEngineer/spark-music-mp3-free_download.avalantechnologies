<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>title</title>
    <style>
        #spinner {
          -webkit-animation: spin 0.9s linear infinite; /* Safari */
          animation: spin 0.9s linear infinite;
          animation-play-state: running;
        }
         /* Safari */
         @-webkit-keyframes spin {
           0% { -webkit-transform: rotate(0deg); }
           100% { -webkit-transform: rotate(360deg); }
         }

        @keyframes spin {
         0% { transform: rotate(0deg); }
         100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="header" style="border-radius: 20px;float: left;margin-left: 5%;width: 90%;height: 120;background-color: limegreen;margin-top: 40px;">
        <center><h2 style="font-size: 50px;font-weight: bold;font-family: 'Courier New', Courier, monospace;color: blueviolet;">Spark music Entertainment</h2></center>
    </div>
    <center><div id="vi" style="width: 80%;height: 500px;padding-top: 200px; display: none;">
      <iframe width="100%" height="100%"  frameborder="0" allow="accelerometer; autoplay;" allowfullscreen id="video" ></iframe>
    </div></center>  
    <center><div id="image_dis" style="width: 80%;height: 500px;padding-top: 200px; display: block;">
        <img src="data:image/jpeg;base64,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" width="80%" height="500px">
    </div></center>
    <div id="search_elements" style="width: 100%;height: 100px;background-color: transparent;border: none;display: inline-block;margin-top: 150px;">
        <input type="text" id="search_bar" placeholder="search song ..." style="border-radius: 10px;border: 5px solid blue;width:60%;height: 70px;font-size: 45px;font-style: italic;float: left;margin-left: 2%;background-color: gray;color: white;cursor: pointer;">
        <button onclick="search_function(1)" id="search_button" name="search_button" style="border-radius: 10px;font-size: 40px;background-color: transparent;border: 3px solid blue;height: 80px;width:15%;float: left;margin-left: 65%;margin-top: -80px;"><p style="font-style: italic;font-size: 40px;color: blueviolet;font-weight: bold;display: normal;margin-top: 7px;" id="search">Search</p><center><div id="spinner" style="border: 10px solid white;border-bottom: 10px solid green;border-top: 10px solid green;border-radius: 50%;height: 45px;width: 45px;display: none;"></div></center></button>
        <button onclick="search_function(0)" id="cancel" name="cancel" style="border-radius: 10px;border: 3px solid red;font-size: 40px;height: 80px;width: fit-content;font-weight: bold;font-style: italic;color: blue;background-color: pink;float: right;margin-right: 4%;margin-top: -80px;">Cancel</button>
    </div>
    <div id="result_container" style="display: block;border-radius: 30px;background-color: transparent;width: 90%;height: fit-content;float: left;margin-left: 5%;">
      <h3 style="font-size: 40px;font-style: italic;font-weight: bold;color: blueviolet;" id="found"> o---o---o---o--o---o---o---oo---o---o---o---o---o---o---o</h2>
     
    </div>
    <script>
        function search_function(value){
            //var image_dis = document.getElementById('image_dis');
              // image_dis.style.display = 'none';
            var result_container = document.querySelectorAll('#result_container *');
            var result_ = document.querySelectorAll('#result_');
            if(result_){
                result_container.forEach((element) =>{
                  if(element in result_){
                    element.remove();
                  }
                });
                
            }
            var spin = document.getElementById('spinner');
            var search = document.getElementById('search');
            search.style.display = 'none';
            spin.style.display = 'block';
            var search_val = document.getElementById('search_bar').value;
            if(value == 1){
               get_search_results(search_val);
            } else {

            }
        }
        function get_search_results(search_value){
            var request_url = `https://youtube-search-and-download.p.rapidapi.com/search?query=${search_value}`;
           
            const options = {
	        method: 'GET',
	        headers: {
		    'content-type': 'application/octet-stream',
		    'X-RapidAPI-Key': 'fc2b872c24mshde91f0830eea461p1f75a8jsn1388ffee2916',
		    'X-RapidAPI-Host': 'youtube-search-and-download.p.rapidapi.com'
	        }
           };
       
           //var count  = response.contents.length;
           var videoid_array = [], title_array = [], timestamp_array = [], views_array = [], image_array = [], downloadlink_array = [];
           var count = 0;
	         fetch(request_url, options)
             .then(response => response.json())
             .then((data) => {
                var c = 0;
                for(var i = 0; i < data.contents.length; i++){
                   if(data.contents[i].hasOwnProperty("video")){ 
                     videoid_array.push(data.contents[i].video.videoId);
                     title_array.push(data.contents[i].video.title);        
                     timestamp_array.push(data.contents[i].video.publishedTimeText);
                     views_array.push(data.contents[i].video.viewCountText);
                     image_array.push(data.contents[i].video.thumbnails[0].url);      
                     c += 1;
                    }
                    //console.log(data.contents);
                }     
                count = c;
                const options1 = {
                           method: 'GET',
                           headers: {
                              'X-RapidAPI-Key': '68ca2b29famsh3659961ddfd0bc6p13afa2jsn2558945f180c',
                              'X-RapidAPI-Host': 'youtube-mp3-download1.p.rapidapi.com'
      }
};
                for(var i =0; i < count; i++){
                    fetch(`https://youtube-mp4-download1.p.rapidapi.com/dl?id=${videoid_array[0]}`, options1)
                    .then(response => response.json())
                    .then((response) =>{
                    console.log(response.link);
                    //downloadlink.href = response.link
                    //downloadlink.target="_blank"
                 } );
                }
                var h2_heading = document.createElement('h2');
                h2_heading.style.fontSize = '30px';
                h2_heading.style.color = 'purple';
                h2_heading.style.fontStyle = 'italic';
                var txt = document.createTextNode('Found: ' + count + ' result');
                h2_heading.appendChild(txt);
                result_container.appendChild(h2_heading);
                for(var i = 0; i < views_array.length; i++){
           
            //creating a div to hold the elements
            const main_div = document.createElement('div');
            main_div.id = 'result_';
            //var main_div = document.getElementById('result_1');
            main_div.style.width = '100%';
            main_div.style.height = 'fit-content';
            main_div.style.display = 'inline-block';
            main_div.style.border = '2px solid blueviolet';
            main_div.style.backgroundColor = 'lavender';
            main_div.style.borderRadius = '10px';
            
            // creating the image element
            const main_img = document.createElement('img');
            main_img.src = image_array[i];
            main_img.id = 'img';
            main_img.style.height = '200px';
            main_img.style.width = '200px';
            main_img.borderRadius = '40px';
            main_img.onclick = function(){
                var lin = `https://www.youtube.com/watch?v=${videoid_array[i]}`;
               window.open(lin);
            }
            // image div
            const image_div = document.createElement('div');
            image_div.id = 'image_div';
            image_div.style.borderRadius = '40px';
            image_div.style.height = 'fit-content';
            image_div.style.width = 'fit-content';
            image_div.appendChild(main_img);

            //creating the title element
            const div2 = document.createElement('div');
            div2.id = 'title_views';
            //var title_views = document.getElementById('title_views');
            //div2.style.backgroundColor = 'red';
            div2.style.display = 'block';
            div2.style.float = 'left';
            div2.style.width = '50%';
            div2.style.marginLeft = '30%';
            div2.style.marginTop = '-170px'

            const title  = document.createElement('h3');
            title.id = 'title';
            //var title = document.getElementById('title');
            title.style.fontStyle = 'italic';
            title.style.fontSize = '30px';
            title.style.color = 'green';
            var text0 = document.createTextNode(title_array[i]);
            title.appendChild(text0);

            const views  = document.createElement('h4');
            views.id = 'views';
            //var views = document.getElementById('views');
            views.style.fontStyle = 'italic';
            views.style.fontSize = '25px';
            views.style.marginTop = '-20px';
            
            var text = document.createTextNode(views_array[i]);
            views.appendChild(text);
            views.style.color = 'blueviolet';

            div2.appendChild(title);
            div2.appendChild(views);
            // creating download link
            const link = document.createElement('a');
            fetch(`https://youtube-mp3-download1.p.rapidapi.com/dl?id=${videoid_array[i]}`, options1)
                    .then(response => response.json())
                    .then((response) => {
                        link.href = response.link;
                      //console.log(downloadlink_array[0]);
                    });
           
            console.log(link.href);
            link.target = '_blank';
            link.height = '120px';
            link.width = 'fit-content';
            link.fontSize = '50px';
            var text1 = document.createTextNode('Download');
            text1.fontSizeAdjust = '50px';
            link.download = 'true';
            link.appendChild(text1);
            
            // creating link div
            const linkDiv = document.createElement('div');
            linkDiv.id = 'linkDiv';
            linkDiv.style.float = 'left';
            linkDiv.style.marginLeft = '85%';
            linkDiv.style.marginTop = '-130px';
            linkDiv.borderRadius = '20px';
            linkDiv.backgroundColor = 'green';
            linkDiv.color = 'green';
            linkDiv.appendChild(link);

            // appaending the elements in the main div 
            main_div.appendChild(image_div);
            main_div.appendChild(div2);
            main_div.appendChild(linkDiv);
            //main_img.appendChild(div2);
           
            document.getElementById('result_container').appendChild(main_div);
            var spin = document.getElementById('spinner');
            var search = document.getElementById('search');
            search.fontSize = '30px';
            search.style.display = 'block';
            spin.style.display = 'none';
            
           }

                //console.log(count);       
             });
           
           //console.log(image_array);  
           //console.log(views_array)  
           // creating download links
           //var downloadlinks_array = [];
           //for(var i = 0; i < count; i++){
             //fetch(`https://youtube-mp3-download1.p.rapidapi.com/dl?id=${videoid_array[i]}`, options)
             //.then(response => response.json())
             //.then((response) => {
               // downloadlinks_array.push(response);
            /// });
           //}
           //console.log(downloadlinks_array);
           console.log(views_array.length);
           //var resul = document.getElementById('result_container');
           
          // const download_url = `https://youtube-mp3-download1.p.rapidapi.com/dl?id=${idname}`
        }
    </script>
</body>
</html>